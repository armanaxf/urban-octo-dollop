---
import ThemeToggle from './ThemeToggle.astro';
import { Image } from 'astro:assets';

const navItems = [
  { href: '/', label: 'Home' },
  { href: '/posts', label: 'Blog' },
  { href: '/about', label: 'About' },
];
---

<header class="sticky top-0 z-50 w-full border-b border-gray-200/80 dark:border-gray-800/80 bg-white/80 dark:bg-dark-900/80 backdrop-blur-md transition-colors duration-300">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between max-w-4xl">
    <a href="/" class="flex items-center gap-2 group">
      <div class="relative w-8 h-8 overflow-hidden rounded-lg shadow-md group-hover:shadow-lg transition-all duration-300">
        <img src="/favicon.ico" alt="Logo" class="w-full h-full object-cover" />
      </div>
      <span class="font-bold text-xl tracking-tight bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-300 bg-clip-text text-transparent group-hover:to-primary-600 dark:group-hover:to-primary-400 transition-all duration-300">
        Josh Giles
      </span>
    </a>

    <nav class="hidden sm:flex items-center gap-1">
      {navItems.map(item => (
        <a 
          href={item.href}
          class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-800 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 relative group"
        >
          {item.label}
          <span class="absolute bottom-1.5 left-4 right-4 h-0.5 bg-primary-500 scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left rounded-full"></span>
        </a>
      ))}
      <div class="w-px h-6 bg-gray-200 dark:bg-gray-700 mx-2"></div>
      <ThemeToggle />
    </nav>

    <!-- Mobile Menu Button -->
    <button 
      id="mobile-menu-btn"
      class="sm:hidden p-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-800 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500/50"
      aria-label="Toggle menu"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden sm:hidden border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-dark-900 animate-slide-in-top">
    <div class="px-4 py-4 space-y-2">
      {navItems.map(item => (
        <a 
          href={item.href}
          class="block px-4 py-2 text-base font-medium text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-dark-800 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"
        >
          {item.label}
        </a>
      ))}
      <div class="px-4 py-2 border-t border-gray-100 dark:border-gray-800 mt-2 pt-2 flex items-center justify-between">
        <span class="text-sm font-medium text-gray-500 dark:text-gray-400">Appearance</span>
        <ThemeToggle />
      </div>
    </div>
  </div>
</header>

<script>
  const mobileBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileBtn && mobileMenu) {
    mobileBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }
</script>

<style>
  @keyframes slideInTop {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .animate-slide-in-top {
    animation: slideInTop 0.2s ease-out forwards;
  }
</style>
