---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
	title: string;
	description?: string;
	image?: string;
}

const { 
	title, 
	description = "A collection of my thoughts and ramblings on Microsoft's Power Platform", 
	image = "/og-image.png" 
} = Astro.props;

const umamiWebsiteId = import.meta.env.PUBLIC_UMAMI_WEBSITE_ID;
const umamiScriptUrl = import.meta.env.PUBLIC_UMAMI_SCRIPT_URL || 'https://analytics.umami.is/script.js';
---

<!doctype html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={image} />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={image} />

		<title>{title}</title>

		<!-- Umami Analytics -->
		{umamiWebsiteId && (
			<script 
				defer 
				src={umamiScriptUrl} 
				data-website-id={umamiWebsiteId}
			></script>
		)}

		<script is:inline>
			// Theme script to prevent flash of wrong theme
			if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
				document.documentElement.classList.add('dark')
			} else {
				document.documentElement.classList.remove('dark')
			}
		</script>
	</head>
	<body class="bg-gray-50 dark:bg-dark-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 min-h-screen flex flex-col font-sans selection:bg-primary-500/30 selection:text-primary-900 dark:selection:text-primary-100">
		<Header />
		
		<slot name="hero" />
		
		<main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 max-w-4xl py-8">
			<slot />
		</main>

		<Footer />

		<!-- Buy Me a Coffee Widget -->
		<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="joshlgiles" data-description="Support me on Buy me a coffee!" data-message="Thanks for visiting! If you found my content helpful, consider buying me a coffee â˜•" data-color="#5B4B6F" data-position="Right" data-x_margin="18" data-y_margin="48"></script>
	</body>
</html>
